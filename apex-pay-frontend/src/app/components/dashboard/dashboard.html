<div class="terminal-wrapper">
  <div class="header">
    <h1 class="flex items-center gap-3 text-2xl font-bold uppercase tracking-widest">
      <span class="status-indicator"></span> 
      ApexPay Network Interface
    </h1>
    
    <div class="header-meta">
      <span>LOGGED_IN: <span class="text-white">ADMIN_SYSTEM</span></span>
      <span>NODE: <span class="text-white">HEDERA_TESTNET_792</span></span>
      <span>DATE: <span class="text-white">{{ today | date:'yyyy.MM.dd HH:mm:ss' }}</span></span>
    </div>
  </div>

  <div class="stats-grid">
    <div class="terminal-card">
      <div class="text-xs opacity-50 uppercase tracking-tighter">Vault_HBAR_Balance</div>
      <div class="text-3xl font-bold">1,240.50 ‚Ñè</div>
    </div>
    <div class="terminal-card">
      <div class="text-xs opacity-50 uppercase tracking-tighter">Compliance_Status</div>
      <div class="text-3xl text-yellow-400">ENFORCED</div>
    </div>
    <div class="terminal-card">
      <div class="text-xs opacity-50 uppercase tracking-tighter">Active_Oracle_ID</div>
      <div class="text-xl font-mono break-all mt-1">0.0.4551203</div>
    </div>
  </div>

  <div class="terminal-card p-0">
    <div class="table-container">
      <p-table [value]="displayEmployees()" class="retro-table">
        <ng-template pTemplate="header">
          <tr>
            <th>EMPLOYEE_NAME</th>
            <th>HEDERA_ID_PATH</th>
            <th>VALIDATION_HEX</th>
            <th>STATUS</th>
            <th>OPERATIONS</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-emp>
          <tr (click)="viewEmployeeDetails(emp)" class="cursor-pointer hover:bg-green-500/5 transition-colors group">
  <td class="font-bold text-green-500 group-hover:text-green-300">
    > {{ emp.fullName }}
  </td>

  <td class="font-mono opacity-80">{{ emp.hederaAccountId }}</td>

  <td class="font-mono text-xs opacity-50">
    0x{{ emp.id ? emp.id.toString().substring(0,8) : 'NEW_NODE' }}...FF
  </td>

  <td>
    <span [class]="emp.isApprovedByAI ? 'text-green-400' : 'text-yellow-600 font-blink'">
      {{ emp.isApprovedByAI ? '>> APPROVED' : '>> PENDING' }}
    </span>
  </td>

  <td (click)="$event.stopPropagation()">
    <div class="flex gap-2">
      <button pButton 
              icon="pi pi-shield" 
              label="VALIDATE" 
              class="p-button-sm p-button-outlined" 
              (click)="onApprove(emp.hederaAccountId)">
      </button>
      
      <button pButton 
              icon="pi pi-unlock" 
              label="RELEASE" 
              class="p-button-sm p-button-outlined" 
              [disabled]="!emp.isApprovedByAI" 
              (click)="onWithdraw(emp.hederaAccountId)">
      </button>
    </div>
  </td>
</tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="footer-meta">
    <span>SYSTEM_ENCRYPTION: <span class="text-white">AES-256</span></span>
    <span>CONNECTION_STRENGTH: <span class="text-white">98%</span></span>
  </div>
</div>

<div class="vintage-overlay" *ngIf="showPopup">
  <div class="vintage-popup">
    <div class="popup-header">SYSTEM_MESSAGE</div>
    <div class="popup-body">
      <p class="font-mono text-green-500">> {{ popupMessage }}</p>
      <button class="terminal-btn mt-4" (click)="showPopup = false">ACKNOWLEDGE</button>
    </div>
  </div>
</div>

<div class="vintage-overlay" *ngIf="showHistoryModal()">
  <div class="vintage-popup max-w-lg w-full">
    <div class="popup-header flex justify-between">
      <span>LEDGER_HISTORY_STREAM</span>
      <span class="text-xs opacity-50">{{ today | date:'HH:mm:ss' }}</span>
    </div>
    
    <div class="popup-body">
      <div class="max-h-64 overflow-y-auto pr-2 custom-scrollbar">
        <div *ngFor="let item of selectedEmployeeHistory()" class="border-b border-green-900/30 py-3 flex justify-between items-center text-left">
          <div class="flex flex-col">
            <span class="text-[10px] opacity-50 uppercase tracking-widest">{{ item.event }}</span>
            
            <span class="text-[9px] text-green-700 font-mono" *ngIf="item.date">
              {{ item.date | timeAgo }}
            </span>
          </div>
          
          <span class="text-green-400 font-mono text-sm">{{ item.value }}</span>
        </div>
      </div>
      
      <button class="terminal-btn mt-6 w-full" (click)="closeModal()">
        TERMINATE_DATA_STREAM
      </button>
    </div>
  </div>
</div>